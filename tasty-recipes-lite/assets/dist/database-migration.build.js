(()=>{"use strict";var e={n:t=>{var s=t&&t.__esModule?()=>t.default:()=>t;return e.d(s,{a:s}),s},d:(t,s)=>{for(var r in s)e.o(s,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:s[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.domReady;var s=e.n(t);const r=window.wp.i18n;s()(()=>{const e=document.getElementById("tasty-recipes-db-migration-notice"),t=document.getElementById("tasty-recipes-run-migration");if(!e||!t)return;const{nonce:s,ajaxUrl:a}=window.tastyRecipesDatabaseMigration||{};if(!s||!a)return;const n=e.querySelector(".tasty-recipes-migration-message"),i=t.querySelector(".tasty-recipes-loading-text"),o=s=>{t.classList.remove("is-loading");const a=(0,r.__)("Error:","tasty-recipes-lite");n.innerHTML=`<strong>${a}</strong> ${s}`,e.style.borderLeftColor="#d63638"},c=async(d=0)=>{t.classList.add("is-loading");const l=new FormData;l.append("action","tasty_recipes_run_db_migration"),l.append("_ajax_nonce",s),l.append("offset",d);try{const s=await fetch(a,{method:"POST",credentials:"same-origin",body:l}),d=await s.json();if(!d.success){const e=(0,r.__)("An error occurred during migration.","tasty-recipes-lite");return void o(d.data?.message||e)}if(!d.data.complete)return i.textContent=(0,r.sprintf)(/* translators: %d: number of remaining recipes */ /* translators: %d: number of remaining recipes */
(0,r.__)("Updatingâ€¦ (%d remaining)","tasty-recipes-lite"),d.data.remaining),void await c(d.data.offset);(()=>{t.classList.remove("is-loading"),e.classList.remove("notice-warning"),e.classList.add("is-success");const s=(0,r.__)("Success!","tasty-recipes-lite"),a=(0,r.__)("Database update completed successfully.","tasty-recipes-lite");n.innerHTML=`<strong>${s}</strong> ${a}`})()}catch(e){o((0,r.__)("An error occurred during migration.","tasty-recipes-lite"))}};t.addEventListener("click",e=>{e.preventDefault(),c(0)})})})();